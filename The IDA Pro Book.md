# 第一部分  IDA简介

## 第1章 反汇编简介

* 反汇编理论
  * 第一代语言：0和1、机器语言、字节码。机器语言程序常被称为二进制文件
  * 第二代语言：汇编语言，助记符与具体的位模式或操作码联系起来。汇编器将汇编语言程序转换成能够执行的机器语言
  * 第三代语言：引入关键字和结构，不依赖任何平台。常使用编译器转换成汇编语言或直接转换为机器语言（或大致等价的形式，如字节码）
  * 第四代语言：存在，但无关，不讨论
  
* 何为反汇编
  * 撤销汇编和编译过程：反汇编器、反编译器（直接输出高级语言）
  * 反汇编的困难
    * 编译过程会造成损失：机器语言中没有变量或函数名
    * 编译属于多对多操作：源程序与汇编语言间是多对多关系
    * 反编译器非常依赖于语言和库：用对Windows编程API一无所知的反编译器处理编译后的Windows二进制文件不会得到任何有用的结果
    * 想要准确地反编译一个二进制文件，需要近乎完美的反汇编能力：反汇编阶段的任何错误或遗漏都会影响反编译代码
  
* 为何反汇编
  * 分析恶意软件
    * 动态分析和静态分析是分析恶意软件的两种主要技术
    * **动态分析**：在严格控制的环境（沙盒）中执行恶意软件，并使用系统检测实用工具记录其所有行为
    * **静态分析**：通过浏览程序代码来理解程序的行为，此时要查看的就是对恶意软件进行反汇编之后的代码清单
  * 分析闭源软件的漏洞
  * 分析闭源软件的互操作性
  * 分析编译器生成的代码，以验证编译器的性能和准确性
  * 在调试时显示程序指令
  
* 如何反汇编、

  * 基本的反汇编算法

    1. 确定进行反汇编的代码区域

       | 操作系统 | 可执行文件格式                     |
       | -------- | ---------------------------------- |
       | Windows  | Portable Executable, PE            |
       | Unix     | Executable and linking format, ELF |

    2. 知道起始地址后，读取该地址（或文件偏移量）所包含的值，并执行表查找，将二进制操作码与其汇编语言助记符对应起来

    3. 对汇编语言等价形式进行格式化，并将其在反汇编代码中输出。多种汇编语言输出格式可供选择：如，X86汇编语言所使用的两种主要格式为Intel格式和AT&T格式

       | 汇编语言格式 | 特点                                                         |
       | ------------ | ------------------------------------------------------------ |
       | AT&T         | %作为寄存器名称前缀，$作为文字常量（立即数）的前缀，源操作数在左边，目的操作数在右边：`add $0x4, %eax`, GUN汇编器和其它GNU工具（gcc、gdb）都使用AT&T语法 |
       | Intel        | 不需要寄存器和文字前缀，操作数排序方式与AT&T恰相反：`add eax, 0x4`, 微软汇编器MASM、Borland的Turbo汇编器TASM和Netwide汇编器NASM使用 |

    4. 输出一条指令后，继续反汇编下一条指令，并重复上述过程，直到反汇编完全文件中的所有指令

  * 大量算法可用于确定何处开始反汇编，如何选择下一条反汇编指令，如何确定代码与数据，以及如何确定何时完成最后一条指令的反汇编。**线性扫描**和**递归下降**是两种最主要的反汇编算法

  * **线性扫描反汇编**

    * 能够完全覆盖程序的所有代码段，但没有考虑到代码中可能混有数据

  * **递归下降反汇编**

    * 强调控制流的概念，控制流根据一条指令是否被另一条指令引用来决定是否对其进行反汇编
    * 控制流
      * 顺序流指令
      * 条件分支指令
      * 无条件分支指令
      * 函数调用指令
      * 返回指令
    * 具有区分代码与数据的强大能力
    * 无法处理间接代码路径，如利用指针表来查找目标地址的跳转或调用。然而，通过采用一些用于识别指向代码的指针的启发（heuristics）式方法可以解决。
    * IDA Pro是一种最为典型的递归下降反汇编器，**了解递归下降过程**有助于我们**识别IDA无法进行最佳反汇编的情形**，以及**制定策略来改进IDA的输出结果**。

## 第2章 逆向与反汇编工具



## 第3章 IDA Pro 背景知识

# 第二部分 IDA基本用法

## 第4章 IDA入门

## 第5章 IDA数据显示窗口

## 第6章 反汇编导航

## 第7章 反汇编操作

## 第8章 数据类型与数据交互

## 第9章 交叉引用与绘图功能

## 第10章 IDA的多种面孔